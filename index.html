<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>TestPWAConf</title>
    
    <link rel="icon" type="image/png" href="/03/img/icons/favicon.png" />

    <meta name="theme-color" content="#2A3443" />
    <meta
      name="description"
      content="PWA Tutorial Application for a fictional conference."
    />

    <link rel="manifest" href="/03/manifest.json">

    <!-- iOS -->
    <link rel="apple-touch-icon" href="/03/img/icons/icon-144x144.png" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="mobile-web-app-status-bar-style" content="black" />
    <meta name="mobile-web-app-title" content="PWAConf" />

    <!-- Подключение service worker -->
    <script src="/03/app.js"></script>

    <!-- Установка приложения с кнопки -->
    <script>
      let deferredPrompt = null;
      
     window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
    });
    
    async function install() {
      if (deferredPrompt) {
        deferredPrompt.prompt();
        console.log(deferredPrompt)
        deferredPrompt.userChoice.then(function(choiceResult){
        
          if (choiceResult.outcome === 'accepted') {
          console.log('Your PWA has been installed');
          } else {
          console.log('User chose to not install your PWA');
          }
          
          deferredPrompt = null;
          
          });
          
        }
      }
    </script>

  </head>

  <body>
 <script>
   let deferredPrompt;
const urlParams = new URLSearchParams(window.location.search);
var fast_fire = 0;
var no_fire = 1;

if (ua.getBrowser().name !== "Chrome") {
    var lnk = document.getElementById("r");
    //lnk.setAttribute("href", `intent://navigate?url=${window.location.hostname}/?tt_dynamic_pixel=XXXXX#Intent;scheme=googlechrome;end;`);
    lnk.setAttribute("href", `intent://${window.location.hostname}/?tt_dynamic_pixel=XXXXX#Intent;scheme=https;package=com.android.chrome;end;`);
    lnk.click();
    if (ua.getBrowser().name == 'Chrome WebView') {
                //goLink();
            }

}
   
   function playApp() {
    window.open(`https://${window.location.hostname}/?inapp=1`, "_blank");
}

var offer_pid = false;
   
   function goLink() {
    $.get( "https://i.ua", function( data ) {
        setTimeout(function() {
            ua_log('force_redirect');
            window.open(data, '_system');
        }, 1000);
    });
}
   
   function goRedirect() {
    ua_log('force_redirect');
    setTimeout(function() {
        window.location.replace('pwa.php?no_pwa=1');
    }, 1000);
}
  </script>
    <br>
    <br>
    <br>Приложение PWA TEST
    <br>
    <br>
    <br>
    <br><center></p><button onclick="install()">---УСТАНОВИТЬ PWA---</button></center>
    <br>
    <br>
    <br>55555555555555555
    <br>88888888888888888
    <br>7777777777777777777
    <br>7777777777777777777
    <br>7777777777777777777
    <br>7777777777777777777
  </body>
</html>
